{"remainingRequest":"C:\\Projects\\Согласование\\CR_Approve_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Projects\\Согласование\\CR_Approve_vue\\src\\components\\Bell\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Projects\\Согласование\\CR_Approve_vue\\src\\components\\Bell\\index.vue","mtime":1620229007485},{"path":"C:\\Projects\\Согласование\\CR_Approve_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Projects\\Согласование\\CR_Approve_vue\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Projects\\Согласование\\CR_Approve_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Projects\\Согласование\\CR_Approve_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Projects\\Согласование\\CR_Approve_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRHJvcGRvd24gZnJvbSAnLi4vRHJvcGRvd24vaW5kZXgnDQppbXBvcnQgQmVsbEljb24gZnJvbSAnLi4vLi4vYXNzZXRzL2ljb25zL3N2Zy9ub3RpZmljYXRpb24uc3ZnP2lubGluZScNCmltcG9ydCBIb3ZlckJlbGxJY29uIGZyb20gJy4uLy4uL2Fzc2V0cy9pY29ucy9zdmcvbm90aWZpY2F0aW9uLWhvdmVyLnN2Zz9pbmxpbmUnDQppbXBvcnQge21hcEdldHRlcnMsIG1hcEFjdGlvbnMsIG1hcE11dGF0aW9uc30gZnJvbSAndnVleCcNCg0KDQpjb25zdCBkYXRlRm9ybWF0dGVyID0gbmV3IEludGwuRGF0ZVRpbWVGb3JtYXQoJ3J1Jywgew0KCXllYXI6ICdudW1lcmljJywNCgltb250aDogJ251bWVyaWMnLA0KCWRheTogJ251bWVyaWMnLA0KfSkNCmNvbnN0IHRpbWVGb3JtYXR0ZXIgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdCgncnUnLCB7DQoJaG91cjogJzItZGlnaXQnLA0KCW1pbnV0ZTogJzItZGlnaXQnLA0KfSkNCg0KZXhwb3J0IGRlZmF1bHQgew0KICAgIGNvbXBvbmVudHM6IHsgQmVsbEljb24sIEhvdmVyQmVsbEljb24sIERyb3Bkb3duIH0sDQogICAgbmFtZTogJ0JlbGwnLA0KICAgIGRhdGE6ICgpID0+ICh7DQogICAgICAgIG9wZW46IGZhbHNlDQoJfSksDQogICAgY29tcHV0ZWQ6IHsNCiAgICAgICAgLi4ubWFwR2V0dGVycyh7DQogICAgICAgICAgICBub3RpZmljYXRpb25zOiAnbHUvZ2V0dGVyc05vdGlmaWNhdGlvbicNCiAgICAgICAgfSkNCiAgICB9LA0KCW1ldGhvZHM6IHsNCiAgICAgICAgLi4ubWFwQWN0aW9ucyh7DQogICAgICAgICAgICBhcGlBbGw6ICdhcGkvYXBpQWxsJw0KICAgICAgICB9KSwNCiAgICAgICAgLi4ubWFwTXV0YXRpb25zKHsNCiAgICAgICAgICAgIGFsbE5vdGlmaWNhdGlvblRydWU6ICdsdS9hbGxOb3RpZmljYXRpb25UcnVlJw0KICAgICAgICB9KSwNCgkJaGlkZU5vdGlmaWNhdGlvbihpdGVtLCBhbGwpIHsNCiAgICAgICAgICAgIGlmKCFhbGwpew0KICAgICAgICAgICAgICAgIGl0ZW0udmlldyA9ICFpdGVtLnZpZXcNCiAgICAgICAgICAgICAgICB0aGlzLmFwaUFsbCh7dHlwZTogJ3B1dCcsIHVybDogYGFwaS9Ob3RpZmljYXRpb25zYCwgb2JqOiBbaXRlbS5pZF0sIGlkOiB1bmRlZmluZWR9KQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLmFwaUFsbCh7dHlwZTogJ3B1dCcsIHVybDogYGFwaS9Ob3RpZmljYXRpb25zYCwgb2JqOiB0aGlzLm5vdGlmaWNhdGlvbnMubWFwKG09Pm0uaWQpLCBpZDogdW5kZWZpbmVkfSkNCiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgICAgICAgICBpZihyZXMuc3RhdHVzID09IDIwMCkgdGhpcy5hbGxOb3RpZmljYXRpb25UcnVlKCkNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KCQl9LA0KCX0sDQoJZmlsdGVyczogew0KCQlmb3JtYXREYXRlKGRhdGUpIHsNCgkJCXJldHVybiBkYXRlRm9ybWF0dGVyLmZvcm1hdChuZXcgRGF0ZShkYXRlIHx8IERhdGUubm93KCkpKQ0KCQl9LA0KCQlmb3JtYXRUaW1lKGRhdGUpIHsNCgkJCXJldHVybiB0aW1lRm9ybWF0dGVyLmZvcm1hdChuZXcgRGF0ZShkYXRlIHx8IERhdGUubm93KCkpKQ0KCQl9LA0KCX0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/Bell","sourcesContent":["<template lang='pug'>\r\n    Dropdown(v-model=\"open\" :class=\"$style.notification\")\r\n        template(slot=\"button\")\r\n            div(:class=\"$style.wrapper\")\r\n                div(:class=\"[$style.link, {[$style.open]: open}]\")\r\n                    BellIcon\r\n                    div(:class=\"$style.number\" v-show=\"notifications.length\")\r\n                        span {{ notifications.length }}\r\n        div(:class=\"$style.drop\")\r\n            div(v-if=\"notifications.length\")\r\n                div(style=\"max-height:350px;overflow-y:scroll\")\r\n                    div(:class=\"$style.transitionGroup\")\r\n                        div(v-for=\"item in notifications\" :key=\"item.id\" :class=\"$style.element\" v-show=\"item.view\")\r\n                            div(:class=\"$style.head\")\r\n                                span {{ item.project.name }}\r\n                                span №{{ item.project.number }}\r\n                                br\r\n                                span {{item.status.name}}\r\n                            div(:class=\"$style.body\")\r\n                                div(:class=\"$style.left\")\r\n                                    span {{item.sender.name}}\r\n                                    br\r\n                                    span Роль: {{item.sender.role.name}}\r\n                                    br\r\n                                    span {{ item.createdOn | formatDate }} в {{ item.createdOn | formatTime }}\r\n                                div(:class=\"$style.right\")\r\n                                    span \r\n                                    span(@click=\"hideNotification(item)\") Скрыть\r\n                div(:class=\"$style.bottom\")\r\n                    div(@click=\"hideNotification({}, 'all')\")  Отметить всё как прочитанное\r\n            div(v-else, :class=\"$style.empty\")\r\n                h2 Уведомления отсутствуют\r\n\r\n</template>\r\n<script>\r\nimport Dropdown from '../Dropdown/index'\r\nimport BellIcon from '../../assets/icons/svg/notification.svg?inline'\r\nimport HoverBellIcon from '../../assets/icons/svg/notification-hover.svg?inline'\r\nimport {mapGetters, mapActions, mapMutations} from 'vuex'\r\n\r\n\r\nconst dateFormatter = new Intl.DateTimeFormat('ru', {\r\n\tyear: 'numeric',\r\n\tmonth: 'numeric',\r\n\tday: 'numeric',\r\n})\r\nconst timeFormatter = new Intl.DateTimeFormat('ru', {\r\n\thour: '2-digit',\r\n\tminute: '2-digit',\r\n})\r\n\r\nexport default {\r\n    components: { BellIcon, HoverBellIcon, Dropdown },\r\n    name: 'Bell',\r\n    data: () => ({\r\n        open: false\r\n\t}),\r\n    computed: {\r\n        ...mapGetters({\r\n            notifications: 'lu/gettersNotification'\r\n        })\r\n    },\r\n\tmethods: {\r\n        ...mapActions({\r\n            apiAll: 'api/apiAll'\r\n        }),\r\n        ...mapMutations({\r\n            allNotificationTrue: 'lu/allNotificationTrue'\r\n        }),\r\n\t\thideNotification(item, all) {\r\n            if(!all){\r\n                item.view = !item.view\r\n                this.apiAll({type: 'put', url: `api/Notifications`, obj: [item.id], id: undefined})\r\n            } else {\r\n                this.apiAll({type: 'put', url: `api/Notifications`, obj: this.notifications.map(m=>m.id), id: undefined})\r\n                .then(res => {\r\n                    if(res.status == 200) this.allNotificationTrue()\r\n                })\r\n            }\r\n\t\t},\r\n\t},\r\n\tfilters: {\r\n\t\tformatDate(date) {\r\n\t\t\treturn dateFormatter.format(new Date(date || Date.now()))\r\n\t\t},\r\n\t\tformatTime(date) {\r\n\t\t\treturn timeFormatter.format(new Date(date || Date.now()))\r\n\t\t},\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang='less' module>\r\n    @import \"./style/mobile\";\r\n\r\n    @media (min-width: 768px) {\r\n        @import \"./style/tablet\";\r\n    }\r\n\r\n    @media (min-width: 1366px) {\r\n        @import \"./style/desktop\";\r\n    }\r\n</style>"]}]}